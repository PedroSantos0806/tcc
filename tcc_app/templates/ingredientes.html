{% extends "base.html" %}
{% block content %}
<h1>Estoque (Ingredientes)</h1>

<form method="POST" class="form-box" style="max-width:640px;">
  <h3>Novo Ingrediente</h3>
  <label>Nome</label>
  <input name="nome" required>
  <label>Unidade (ex.: un, g, ml, fatia)</label>
  <input name="unidade">
  <label>Custo por unidade</label>
  <input name="custo" type="number" step="0.01" min="0" required>
  <label>Perecível?</label>
  <select name="perecivel">
    <option value="1">Sim</option>
    <option value="0">Não</option>
  </select>
  <label>Estoque atual</label>
  <input name="estoque_atual" type="number" step="1" min="0" required>
  <label>Estoque mínimo</label>
  <input name="estoque_minimo" type="number" step="1" min="0" required>
  <button type="submit">Salvar</button>
</form>

<table class="table-padrao" style="margin-top:10px;">
  <thead>
    <tr>
      <th>Ingrediente</th><th>Unidade</th><th>Custo</th><th>Perecível</th>
      <th>Estoque</th><th>Mínimo</th><th>Status</th>
    </tr>
  </thead>
  <tbody>
    {% for i in ingredientes %}
    {% set status = 'OK' %}
    {% set cls = 'badge-ok' %}
    {% if i.estoque_atual <= (i.estoque_minimo or 0) %}
      {% set status = 'Baixo' %}
      {% set cls = 'badge-warn' %}
    {% endif %}
    <tr>
      <td>{{ i.nome }}</td>
      <td>{{ i.unidade }}</td>
      <td>{{ i.custo|fmt_money }}</td>
      <td>{{ 'Sim' if i.perecivel else 'Não' }}</td>
      <td>{{ i.estoque_atual|fmt_int }}</td>
      <td>{{ i.estoque_minimo|fmt_int }}</td>
      <td><span class="badge {{ cls }}">{{ status }}</span></td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
