{% extends "base.html" %}
{% block content %}
<h1>Cadastrar Produto</h1>

<form method="POST" class="form-box" id="form-produto">
  <label for="nome">Nome</label>
  <input id="nome" name="nome" required>

  <label for="preco_custo">Preço de Custo (R$)</label>
  <input id="preco_custo" name="preco_custo" type="number" step="0.01" required>

  <label for="preco_venda">Preço de Venda (R$)</label>
  <input id="preco_venda" name="preco_venda" type="number" step="0.01" required>

  <label for="quantidade">Quantidade</label>
  <input id="quantidade" name="quantidade" type="number" min="0" required>

  <label for="categoria">Categoria</label>
  <select id="categoria" name="categoria" required>
    <option value="">Selecione...</option>
    <option value="Vestuário">Vestuário</option>
    <option value="Calçados">Calçados</option>
    <option value="Tecnologia">Tecnologia</option>
  </select>

  <div id="grupo-subcategoria" style="display:none;">
    <label for="subcategoria">Subcategoria</label>
    <select id="subcategoria" name="subcategoria"></select>
  </div>

  <div id="grupo-tamanho" style="display:none;">
    <label for="tamanho">Tamanho</label>
    <select id="tamanho" name="tamanho"></select>
  </div>

  <label for="data_chegada">Data de Chegada</label>
  <input id="data_chegada" name="data_chegada" type="date" required>

  <button type="submit">Salvar</button>
</form>

<script>
(function(){
  const cat = document.getElementById('categoria');
  const gSub = document.getElementById('grupo-subcategoria');
  const gTam = document.getElementById('grupo-tamanho');
  const sub = document.getElementById('subcategoria');
  const tam = document.getElementById('tamanho');

  const opcoes = {
    'Vestuário': {
      subcategorias: ['Camisetas','Calças','Jaquetas','Acessórios'],
      tamanhos: ['PP','P','M','G','GG']
    },
    'Calçados': {
      subcategorias: null,
      tamanhos: ['34','35','36','37','38','39','40','41','42','43','44']
    },
    'Tecnologia': {
      subcategorias: ['Periféricos','Áudio','Câmeras','Acessórios'],
      tamanhos: null
    }
  };

  function popularSelect(select, valores){
    select.innerHTML = '';
    const opt0 = document.createElement('option');
    opt0.value = ''; opt0.textContent = 'Selecione...';
    select.appendChild(opt0);
    (valores || []).forEach(v=>{
      const o = document.createElement('option');
      o.value = v; o.textContent = v;
      select.appendChild(o);
    });
  }

  cat.addEventListener('change', ()=>{
    const v = cat.value;
    if(!v){ gSub.style.display='none'; gTam.style.display='none'; return; }
    const cfg = opcoes[v];

    // reset
    sub.value = ''; tam.value = '';
    gSub.style.display = 'none';
    gTam.style.display = 'none';

    if (v === 'Vestuário'){
      if (cfg.subcategorias){ popularSelect(sub, cfg.subcategorias); gSub.style.display='block'; }
      sub.onchange = ()=>{
        if (sub.value){ popularSelect(tam, cfg.tamanhos); gTam.style.display='block'; }
        else { gTam.style.display = 'none'; tam.value = ''; }
      };
    } else if (v === 'Calçados'){
      popularSelect(tam, cfg.tamanhos); gTam.style.display='block';
    } else if (v === 'Tecnologia'){
      popularSelect(sub, cfg.subcategorias); gSub.style.display='block';
    }
  });
})();
</script>
{% endblock %}
